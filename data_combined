import pandas as pd
import glob
import os

# Get all CSV files in the data folder
csv_files = glob.glob(os.path.join('data', '*.csv'))

# Read and concatenate all CSV files
df = pd.concat([pd.read_csv(file) for file in csv_files], ignore_index=True)

# Filter for Pink Morsels only
df = df[df['product'] == 'Pink Morsels']

# Calculate sales
df['sales'] = df['quantity'] * df['price']

# Select and rename required columns
df = df[['sales', 'date', 'region']]

# Convert date to datetime
df['date'] = pd.to_datetime(df['date'])

# Sort by date
df = df.sort_values('date')

# Write to new CSV file
df.to_csv('formatted_output.csv', index=False)

print("Formatted output has been saved to 'formatted_output.csv'")